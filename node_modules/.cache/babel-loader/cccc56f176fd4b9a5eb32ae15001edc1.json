{"ast":null,"code":"import _slicedToArray from \"/home/minhtranin/work/treenode/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/minhtranin/work/treenode/src/Dragable.js\";\n\nimport { Tree, Input } from 'antd';\nimport React, { useState } from 'react';\nvar Search = Input.Search;\nvar x = 3;\nvar y = 2;\nvar z = 1;\nvar gData = [];\n\nvar generateData = function generateData(_level, _preKey, _tns) {\n  var preKey = _preKey || '0';\n  var tns = _tns || gData;\n  var children = [];\n\n  for (var i = 0; i < x; i++) {\n    var key = \"\".concat(preKey, \"-\").concat(i);\n    tns.push({\n      title: key,\n      key: key\n    });\n\n    if (i < y) {\n      children.push(key);\n    }\n  }\n\n  if (_level < 0) {\n    return tns;\n  }\n\n  var level = _level - 1;\n  children.forEach(function (key, index) {\n    tns[index].children = [];\n    return generateData(level, key, tns[index].children);\n  });\n};\n\ngenerateData(z);\nvar dataList = [];\n\nvar generateList = function generateList(data) {\n  for (var i = 0; i < data.length; i++) {\n    var node = data[i];\n    var key = node.key;\n    dataList.push({\n      key: key,\n      title: key\n    });\n\n    if (node.children) {\n      generateList(node.children);\n    }\n  }\n};\n\ngenerateList(gData);\n\nvar getParentKey = function getParentKey(key, tree) {\n  var parentKey;\n\n  for (var i = 0; i < tree.length; i++) {\n    var node = tree[i];\n\n    if (node.children) {\n      if (node.children.some(function (item) {\n        return item.key === key;\n      })) {\n        parentKey = node.key;\n      } else if (getParentKey(key, node.children)) {\n        parentKey = getParentKey(key, node.children);\n      }\n    }\n  }\n\n  return parentKey;\n};\n\nvar SearchTree = function SearchTree() {\n  //   state = {\n  //     expandedKeys: [],\n  //     searchValue: '',\n  //     autoExpandParent: true,\n  //   };\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      expandedKeys = _useState2[0],\n      setExpandedKeys = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      searchValue = _useState4[0],\n      setSearchValue = _useState4[1];\n\n  var _useState5 = useState(true),\n      _useState6 = _slicedToArray(_useState5, 2),\n      autoExpandParent = _useState6[0],\n      setAutoExpandParent = _useState6[1];\n\n  var onExpand = function onExpand(expandedkeys) {\n    setExpandedKeys(expandedkeys);\n    setAutoExpandParent(false);\n  };\n\n  var onChange = function onChange(e) {\n    var value = e.target.value;\n    var expandedkeys = dataList.map(function (item) {\n      if (item.title.indexOf(value) > -1) {\n        return getParentKey(item.key, gData);\n      }\n\n      return null;\n    }).filter(function (item, i, self) {\n      return item && self.indexOf(item) === i;\n    }); // this.setState({\n    //   expandedKeys,\n    //   searchValue: value,\n    //   autoExpandParent: true,\n    // });\n\n    setExpandedKeys(expandedkeys);\n    setSearchValue(value);\n    setAutoExpandParent(true);\n  }; // const { searchValue, expandedKeys, autoExpandParent } = this.state;\n\n\n  var loop = function loop(data) {\n    return data.map(function (item) {\n      var index = item.title.indexOf(searchValue);\n      var beforeStr = item.title.substr(0, index);\n      var afterStr = item.title.substr(index + searchValue.length);\n      var title = index > -1 ? /*#__PURE__*/React.createElement(\"span\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }\n      }, beforeStr, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"site-tree-search-value\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 15\n        }\n      }, searchValue), afterStr) : /*#__PURE__*/React.createElement(\"span\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }\n      }, item.title);\n\n      if (item.children) {\n        return {\n          title: title,\n          key: item.key,\n          children: loop(item.children)\n        };\n      }\n\n      return {\n        title: title,\n        key: item.key\n      };\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Search, {\n    style: {\n      marginBottom: 8\n    },\n    placeholder: \"Search\",\n    onChange: onChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Tree, {\n    onExpand: onExpand,\n    draggable: true,\n    expandedKeys: expandedKeys,\n    autoExpandParent: autoExpandParent,\n    treeData: loop(gData),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 9\n    }\n  }));\n};\n\nexport default SearchTree;","map":{"version":3,"sources":["/home/minhtranin/work/treenode/src/Dragable.js"],"names":["Tree","Input","React","useState","Search","x","y","z","gData","generateData","_level","_preKey","_tns","preKey","tns","children","i","key","push","title","level","forEach","index","dataList","generateList","data","length","node","getParentKey","tree","parentKey","some","item","SearchTree","expandedKeys","setExpandedKeys","searchValue","setSearchValue","autoExpandParent","setAutoExpandParent","onExpand","expandedkeys","onChange","e","value","target","map","indexOf","filter","self","loop","beforeStr","substr","afterStr","marginBottom"],"mappings":";;;;;AAAA,SAASA,IAAT,EAAeC,KAAf,QAA4B,MAA5B;AACA,OAAOC,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,IAAQC,MAAR,GAAmBH,KAAnB,CAAQG,MAAR;AAEA,IAAMC,CAAC,GAAG,CAAV;AACA,IAAMC,CAAC,GAAG,CAAV;AACA,IAAMC,CAAC,GAAG,CAAV;AACA,IAAMC,KAAK,GAAG,EAAd;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,MAAD,EAASC,OAAT,EAAkBC,IAAlB,EAA2B;AAC9C,MAAMC,MAAM,GAAGF,OAAO,IAAI,GAA1B;AACA,MAAMG,GAAG,GAAGF,IAAI,IAAIJ,KAApB;AAEA,MAAMO,QAAQ,GAAG,EAAjB;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGX,CAApB,EAAuBW,CAAC,EAAxB,EAA4B;AAC1B,QAAMC,GAAG,aAAMJ,MAAN,cAAgBG,CAAhB,CAAT;AACAF,IAAAA,GAAG,CAACI,IAAJ,CAAS;AAAEC,MAAAA,KAAK,EAAEF,GAAT;AAAcA,MAAAA,GAAG,EAAHA;AAAd,KAAT;;AACA,QAAID,CAAC,GAAGV,CAAR,EAAW;AACTS,MAAAA,QAAQ,CAACG,IAAT,CAAcD,GAAd;AACD;AACF;;AACD,MAAIP,MAAM,GAAG,CAAb,EAAgB;AACd,WAAOI,GAAP;AACD;;AACD,MAAMM,KAAK,GAAGV,MAAM,GAAG,CAAvB;AACAK,EAAAA,QAAQ,CAACM,OAAT,CAAiB,UAACJ,GAAD,EAAMK,KAAN,EAAgB;AAC/BR,IAAAA,GAAG,CAACQ,KAAD,CAAH,CAAWP,QAAX,GAAsB,EAAtB;AACA,WAAON,YAAY,CAACW,KAAD,EAAQH,GAAR,EAAaH,GAAG,CAACQ,KAAD,CAAH,CAAWP,QAAxB,CAAnB;AACD,GAHD;AAID,CApBD;;AAqBAN,YAAY,CAACF,CAAD,CAAZ;AAEA,IAAMgB,QAAQ,GAAG,EAAjB;;AACA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAAC,IAAI,EAAI;AAC3B,OAAK,IAAIT,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGS,IAAI,CAACC,MAAzB,EAAiCV,CAAC,EAAlC,EAAsC;AACpC,QAAMW,IAAI,GAAGF,IAAI,CAACT,CAAD,CAAjB;AACA,QAAQC,GAAR,GAAgBU,IAAhB,CAAQV,GAAR;AACAM,IAAAA,QAAQ,CAACL,IAAT,CAAc;AAAED,MAAAA,GAAG,EAAHA,GAAF;AAAOE,MAAAA,KAAK,EAAEF;AAAd,KAAd;;AACA,QAAIU,IAAI,CAACZ,QAAT,EAAmB;AACjBS,MAAAA,YAAY,CAACG,IAAI,CAACZ,QAAN,CAAZ;AACD;AACF;AACF,CATD;;AAUAS,YAAY,CAAChB,KAAD,CAAZ;;AAEA,IAAMoB,YAAY,GAAG,SAAfA,YAAe,CAACX,GAAD,EAAMY,IAAN,EAAe;AAClC,MAAIC,SAAJ;;AACA,OAAK,IAAId,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGa,IAAI,CAACH,MAAzB,EAAiCV,CAAC,EAAlC,EAAsC;AACpC,QAAMW,IAAI,GAAGE,IAAI,CAACb,CAAD,CAAjB;;AACA,QAAIW,IAAI,CAACZ,QAAT,EAAmB;AACjB,UAAIY,IAAI,CAACZ,QAAL,CAAcgB,IAAd,CAAmB,UAAAC,IAAI;AAAA,eAAIA,IAAI,CAACf,GAAL,KAAaA,GAAjB;AAAA,OAAvB,CAAJ,EAAkD;AAChDa,QAAAA,SAAS,GAAGH,IAAI,CAACV,GAAjB;AACD,OAFD,MAEO,IAAIW,YAAY,CAACX,GAAD,EAAMU,IAAI,CAACZ,QAAX,CAAhB,EAAsC;AAC3Ce,QAAAA,SAAS,GAAGF,YAAY,CAACX,GAAD,EAAMU,IAAI,CAACZ,QAAX,CAAxB;AACD;AACF;AACF;;AACD,SAAOe,SAAP;AACD,CAbD;;AAeA,IAAMG,UAAU,GAAG,SAAbA,UAAa,GAAM;AACzB;AACA;AACA;AACA;AACA;AACA,kBAAwC9B,QAAQ,CAAC,EAAD,CAAhD;AAAA;AAAA,MAAO+B,YAAP;AAAA,MAAqBC,eAArB;;AACA,mBAAsChC,QAAQ,CAAC,EAAD,CAA9C;AAAA;AAAA,MAAOiC,WAAP;AAAA,MAAoBC,cAApB;;AACA,mBAAgDlC,QAAQ,CAAC,IAAD,CAAxD;AAAA;AAAA,MAAOmC,gBAAP;AAAA,MAAyBC,mBAAzB;;AAEA,MAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAAC,YAAY,EAAI;AAC3BN,IAAAA,eAAe,CAACM,YAAD,CAAf;AACAF,IAAAA,mBAAmB,CAAC,KAAD,CAAnB;AACH,GAHH;;AAKA,MAAMG,QAAQ,GAAG,SAAXA,QAAW,CAAAC,CAAC,EAAI;AAClB,QAAQC,KAAR,GAAkBD,CAAC,CAACE,MAApB,CAAQD,KAAR;AACA,QAAMH,YAAY,GAAGlB,QAAQ,CAC1BuB,GADkB,CACd,UAAAd,IAAI,EAAI;AACX,UAAIA,IAAI,CAACb,KAAL,CAAW4B,OAAX,CAAmBH,KAAnB,IAA4B,CAAC,CAAjC,EAAoC;AAClC,eAAOhB,YAAY,CAACI,IAAI,CAACf,GAAN,EAAWT,KAAX,CAAnB;AACD;;AACD,aAAO,IAAP;AACD,KANkB,EAOlBwC,MAPkB,CAOX,UAAChB,IAAD,EAAOhB,CAAP,EAAUiC,IAAV;AAAA,aAAmBjB,IAAI,IAAIiB,IAAI,CAACF,OAAL,CAAaf,IAAb,MAAuBhB,CAAlD;AAAA,KAPW,CAArB,CAFkB,CAUlB;AACA;AACA;AACA;AACA;;AACAmB,IAAAA,eAAe,CAACM,YAAD,CAAf;AACAJ,IAAAA,cAAc,CAACO,KAAD,CAAd;AACAL,IAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACD,GAlBH,CAfyB,CAmCrB;;;AACA,MAAMW,IAAI,GAAG,SAAPA,IAAO,CAAAzB,IAAI;AAAA,WACfA,IAAI,CAACqB,GAAL,CAAS,UAAAd,IAAI,EAAI;AACf,UAAMV,KAAK,GAAGU,IAAI,CAACb,KAAL,CAAW4B,OAAX,CAAmBX,WAAnB,CAAd;AACA,UAAMe,SAAS,GAAGnB,IAAI,CAACb,KAAL,CAAWiC,MAAX,CAAkB,CAAlB,EAAqB9B,KAArB,CAAlB;AACA,UAAM+B,QAAQ,GAAGrB,IAAI,CAACb,KAAL,CAAWiC,MAAX,CAAkB9B,KAAK,GAAGc,WAAW,CAACV,MAAtC,CAAjB;AACA,UAAMP,KAAK,GACTG,KAAK,GAAG,CAAC,CAAT,gBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG6B,SADH,eAEE;AAAM,QAAA,SAAS,EAAC,wBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA0Cf,WAA1C,CAFF,EAGGiB,QAHH,CADF,gBAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAOrB,IAAI,CAACb,KAAZ,CARJ;;AAUA,UAAIa,IAAI,CAACjB,QAAT,EAAmB;AACjB,eAAO;AAAEI,UAAAA,KAAK,EAALA,KAAF;AAASF,UAAAA,GAAG,EAAEe,IAAI,CAACf,GAAnB;AAAwBF,UAAAA,QAAQ,EAAEmC,IAAI,CAAClB,IAAI,CAACjB,QAAN;AAAtC,SAAP;AACD;;AAED,aAAO;AACLI,QAAAA,KAAK,EAALA,KADK;AAELF,QAAAA,GAAG,EAAEe,IAAI,CAACf;AAFL,OAAP;AAID,KAtBD,CADe;AAAA,GAAjB;;AAyBA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AAAQ,IAAA,KAAK,EAAE;AAAEqC,MAAAA,YAAY,EAAE;AAAhB,KAAf;AAAoC,IAAA,WAAW,EAAC,QAAhD;AAAyD,IAAA,QAAQ,EAAEZ,QAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAEE,oBAAC,IAAD;AACE,IAAA,QAAQ,EAAEF,QADZ;AAEE,IAAA,SAAS,MAFX;AAGE,IAAA,YAAY,EAAEN,YAHhB;AAIE,IAAA,gBAAgB,EAAEI,gBAJpB;AAKE,IAAA,QAAQ,EAAEY,IAAI,CAAC1C,KAAD,CALhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF;AAYH,CAzED;;AA2EA,eAAeyB,UAAf","sourcesContent":["import { Tree, Input } from 'antd';\nimport React, { useState } from 'react'\nconst { Search } = Input;\n\nconst x = 3;\nconst y = 2;\nconst z = 1;\nconst gData = [];\n\nconst generateData = (_level, _preKey, _tns) => {\n  const preKey = _preKey || '0';\n  const tns = _tns || gData;\n\n  const children = [];\n  for (let i = 0; i < x; i++) {\n    const key = `${preKey}-${i}`;\n    tns.push({ title: key, key });\n    if (i < y) {\n      children.push(key);\n    }\n  }\n  if (_level < 0) {\n    return tns;\n  }\n  const level = _level - 1;\n  children.forEach((key, index) => {\n    tns[index].children = [];\n    return generateData(level, key, tns[index].children);\n  });\n};\ngenerateData(z);\n\nconst dataList = [];\nconst generateList = data => {\n  for (let i = 0; i < data.length; i++) {\n    const node = data[i];\n    const { key } = node;\n    dataList.push({ key, title: key });\n    if (node.children) {\n      generateList(node.children);\n    }\n  }\n};\ngenerateList(gData);\n\nconst getParentKey = (key, tree) => {\n  let parentKey;\n  for (let i = 0; i < tree.length; i++) {\n    const node = tree[i];\n    if (node.children) {\n      if (node.children.some(item => item.key === key)) {\n        parentKey = node.key;\n      } else if (getParentKey(key, node.children)) {\n        parentKey = getParentKey(key, node.children);\n      }\n    }\n  }\n  return parentKey;\n};\n\nconst SearchTree = () => {\n//   state = {\n//     expandedKeys: [],\n//     searchValue: '',\n//     autoExpandParent: true,\n//   };\nconst [expandedKeys, setExpandedKeys] = useState([])\nconst [searchValue, setSearchValue] = useState('')\nconst [autoExpandParent, setAutoExpandParent] = useState(true)\n\nconst onExpand = expandedkeys => {\n      setExpandedKeys(expandedkeys)\n      setAutoExpandParent(false)\n  }\n\nconst onChange = e => {\n    const { value } = e.target;\n    const expandedkeys = dataList\n      .map(item => {\n        if (item.title.indexOf(value) > -1) {\n          return getParentKey(item.key, gData);\n        }\n        return null;\n      })\n      .filter((item, i, self) => item && self.indexOf(item) === i);\n    // this.setState({\n    //   expandedKeys,\n    //   searchValue: value,\n    //   autoExpandParent: true,\n    // });\n    setExpandedKeys(expandedkeys)\n    setSearchValue(value)\n    setAutoExpandParent(true)\n  };\n\n    // const { searchValue, expandedKeys, autoExpandParent } = this.state;\n    const loop = data =>\n      data.map(item => {\n        const index = item.title.indexOf(searchValue);\n        const beforeStr = item.title.substr(0, index);\n        const afterStr = item.title.substr(index + searchValue.length);\n        const title =\n          index > -1 ? (\n            <span>\n              {beforeStr}\n              <span className=\"site-tree-search-value\">{searchValue}</span>\n              {afterStr}\n            </span>\n          ) : (\n            <span>{item.title}</span>\n          );\n        if (item.children) {\n          return { title, key: item.key, children: loop(item.children) };\n        }\n\n        return {\n          title,\n          key: item.key,\n        };\n      });\n    \n    return (\n      <div>\n        <Search style={{ marginBottom: 8 }} placeholder=\"Search\" onChange={onChange} />\n        <Tree\n          onExpand={onExpand}\n          draggable\n          expandedKeys={expandedKeys}\n          autoExpandParent={autoExpandParent}\n          treeData={loop(gData)}\n        />\n      </div>\n    );\n}\n\nexport default SearchTree"]},"metadata":{},"sourceType":"module"}